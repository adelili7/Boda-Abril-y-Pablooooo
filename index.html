<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Abril & Pablo ‚Äî Invitaci√≥n</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Alex+Brush&family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Parisienne&family=Quicksand:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-cream:#F8F5F0;
      --accent:#B8DDE6;
      --deep:#2B2A2F;
      --card-bg: rgba(255,255,255,0.85);
      --rose-gold:#d6a79b;
      --blue:#66c9ff;
      --silver:#c8c8c8;
      --green:#a7ffcf;
      --white:#ffffff;
    }

    html,body{height:100%;margin:0;font-family:Quicksand,system-ui,Arial;background:var(--bg-cream);color:var(--deep);-webkit-font-smoothing:antialiased}
    main{position:relative}

    /* sections container */
    .sections{position:relative;height:100vh;overflow:hidden;perspective:1200px}

    /* basic section layout + flipbook-like 3d transition */
    .section{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
      box-sizing:border-box;
      position:absolute;
      inset:0;
      opacity:0;
      transform-origin:center;
      transition:transform .9s cubic-bezier(.2,.9,.2,1),opacity .6s ease;
      backface-visibility:hidden;
      background-size:cover;
      background-position:center center;
      background-repeat:no-repeat;
      /* smooth parallax origin */
      will-change:background-position, transform;
    }
    .section.active{opacity:1;transform:rotateY(0) translateZ(0);z-index:2}
    .section.prev{opacity:0;transform:rotateY(-90deg) translateZ(-200px)}
    .section.next{opacity:0;transform:rotateY(90deg) translateZ(-200px)}

    /* backgrounds (per user) */
    .portada{background-image:url('fondo_floral.jpg')}
    .page2{background-image:url('fondo_floral1.png')}
    .page3{background-image:url('fondo_floral2.jpg')}
    .page4{background-image:url('fondo_floral3.jpg')}
    .page5{background-image:url('fondo_floral4.png')}

    /* overlay and card */
    .overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(255,255,255,0.35), rgba(255,255,255,0.6));pointer-events:none}
    .card{position:relative;z-index:2;max-width:980px;width:100%;background:var(--card-bg);backdrop-filter: blur(6px);border-radius:18px;padding:28px;box-shadow:0 10px 35px rgba(0,0,0,0.12)}

    .headline{font-family:'Parisienne',cursive;font-size:64px;text-align:center;margin:0 0 8px;color:#2f2f2f}
    .sub{font-family:'Alex Brush',cursive;font-size:42px;text-align:center;color:#3d3d3d;margin:0 0 12px}

    /* ring / svg */
    .ring-button{display:block;margin:14px auto;padding:0;border:0;background:transparent;cursor:pointer;outline:none;position:relative}
    .ring-svg{width:240px;height:240px;display:block}
    .ring-rotate{animation:ringSpin 14s linear infinite;transform-origin:100px 100px}
    @keyframes ringSpin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
    .ring-button:hover{transform:scale(1.03)}
    .ring-spark{position:absolute;left:50%;top:35%;width:140px;height:140px;transform:translate(-50%,-50%);pointer-events:none;border-radius:50%;opacity:0}
    .ring-button.clicked .ring-spark{animation:spark 900ms ease-out forwards}
    @keyframes spark{0%{opacity:0;transform:translate(-50%,-50%) scale(0.6);}30%{opacity:1;transform:translate(-50%,-50%) scale(1.05);}100%{opacity:0;transform:translate(-50%,-50%) scale(1.6);}}

    .verse{font-style:italic;text-align:center;margin-top:12px;color:#3d3d3d;font-family:'Playfair Display',serif;font-size:20px}
    .countdown{display:flex;gap:10px;justify-content:center;margin-top:12px}
    .countdown .box{min-width:64px;padding:10px;border-radius:10px;background:rgba(255,255,255,0.95);text-align:center}
    .countdown .num{font-family:'Playfair Display';font-size:18px}
    .countdown .label{font-size:11px;color:#666}

    .magicBtn{padding:6px 10px;margin:6px 4px;border-radius:12px;background:linear-gradient(45deg,var(--accent),#f8f5f0);color:var(--deep);font-family:'Quicksand',sans-serif;font-weight:600;font-size:13px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.12)}

    .parents-grid{display:flex;justify-content:space-between;gap:16px;align-items:center}
    .parents-grid .col{flex:1;min-width:220px}
    .parent-names{font-family:'Alex Brush',cursive;font-size:26px;color:var(--deep);line-height:1.2}
    .parent-left{text-align:left}
    .parent-right{text-align:right}
    .honor{font-family:'Playfair Display',serif;font-size:22px;text-align:center;margin-top:22px}

    .couple{display:flex;flex-direction:column;align-items:center;gap:12px}
    .photo{max-width:420px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.12)}

    .itinerary{display:flex;flex-direction:column;gap:12px;font-size:16px}
    .it-item{display:flex;gap:12px;align-items:center}
    .it-icon{width:48px;height:48px;border-radius:10px;background:rgba(255,255,255,0.9);display:flex;align-items:center;justify-content:center}

    .gallery-grid{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
    .gallery-grid img{width:160px;height:110px;object-fit:cover;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.12)}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:9999}
    .modal.open{display:flex}
    .modal .box{background:white;padding:20px;border-radius:10px;max-width:520px;width:100%}

    /* cursor hearts handled by JS */
    .magicHeart{position:fixed;pointer-events:none;z-index:99999;width:26px;height:26px;opacity:0;transform:translate(-50%,-50%) scale(1);animation:heartFade 1000ms forwards}
    @keyframes heartFade{0%{opacity:1;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-120%) scale(0.6)}}

    .small{font-size:13px}
    @media (max-width:900px){.headline{font-size:48px}.sub{font-size:30px}}
  </style>
</head>
<body>
  <!-- Audios: mantener autoplay del original -->
  <audio id="marcha" src="marcha_nupcial.mp3" preload="auto" loop autoplay></audio>
  <audio id="eternamente" src="eternamente.mp3" preload="auto"></audio>

  <div class="sections">
    <!-- Page 1: Portada -->
    <section class="section portada active" data-name="portada" data-bg="fondo_floral.jpg">
      <div class="overlay"></div>
      <div class="card">
        <h1 class="headline">Abril & Pablo</h1>
        <h2 class="sub">¬°S√≠, acepto!</h2>

        <button class="ring-button" id="ringBtn" aria-label="Abrir invitaci√≥n">
          <div class="ring-spark"></div>
          <svg class="ring-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <radialGradient id="ringMetal" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#e9eef2"/><stop offset="60%" stop-color="#c9ccd0"/><stop offset="100%" stop-color="var(--rose-gold)"/></radialGradient>
              <radialGradient id="blueGem" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#dff6ff"/><stop offset="60%" stop-color="#66c9ff"/><stop offset="100%" stop-color="#004c99"/></radialGradient>
            </defs>
            <g class="ring-rotate">
              <ellipse cx="100" cy="100" rx="40" ry="12" stroke="url(#ringMetal)" stroke-width="12" fill="none" />
              <path d="M100 58 L110 70 L100 86 L90 70 Z" fill="url(#blueGem)" stroke="#fff" stroke-opacity="0.4" stroke-width="0.6">
                <animateTransform attributeName="transform" type="scale" values="1;1.03;1" dur="2.6s" repeatCount="indefinite"/>
              </path>
              <circle cx="100" cy="60" r="2" fill="#fff" opacity="0.9"><animate attributeName="r" values="2;4;2" dur="1.6s" repeatCount="indefinite"/></circle>
            </g>
          </svg>
        </button>

        <div style="text-align:center;margin-top:8px;">
          <button class="magicBtn" id="clickRingBtn">Clic en el anillo</button>
          <button class="magicBtn" id="pauseMarchBtn">Pausar marcha</button>
          <button class="magicBtn" id="toggleEtern">Reproducir eternamente</button>
        </div>

        <p class="verse">"Quien halla esposa halla el bien"<br><strong>Proverbios 18:22</strong></p>
        <div class="countdown" id="countdown"></div>
      </div>
    </section>

    <!-- Page 2: Padres + foto -->
    <section class="section page2" id="parentsSection" data-name="padres" data-bg="fondo_floral1.png">
      <div class="overlay"></div>
      <div class="card">
        <div class="parents-grid">
          <div class="col"><div class="parent-names parent-left">Eva Aguilar Rend√≥n<br>Pedro P√©rez Hern√°ndez</div></div>
          <div class="col"><div class="parent-names parent-right">Saray Hern√°ndez Santana<br>Pablo Tinoco Carranza <span title="finado">‚úù</span></div></div>
        </div>
        <div class="honor">Tienen el honor de compartir la dicha que enlaza a sus amados hijos.</div>
        <div style="text-align:center;margin-top:16px"><img src="foto1.jpg" alt="Abril y Pablo" class="photo"></div>
      </div>
    </section>

    <!-- Page 3: Itinerario + RSVP -->
    <section class="section page3" id="itinerarySection" data-name="itinerario" data-bg="fondo_floral2.jpg">
      <div class="overlay"></div>
      <div class="card">
        <h2 class="sub">Itinerario</h2>
        <div class="itinerary">
          <div class="it-item"><div class="it-icon">‚õ™</div><div><strong>Ceremonia Religiosa:</strong> 2:00 pm ‚Äî Iglesia Cristiana Palabra de Vida AD <br><a class="small" href="https://maps.app.goo.gl/AWYkNZ44jyshjRUG6" target="_blank">Ver mapa</a></div></div>
          <div class="it-item"><div class="it-icon">üéâ</div><div><strong>Recepci√≥n:</strong> 4:00 pm ‚Äî Jard√≠n El Abuelo, Tlaquiltenango, Morelos <br><a class="small" href="https://maps.app.goo.gl/QLWKyLr16BXANQM37" target="_blank">Ver mapa</a></div></div>
          <div class="it-item"><div class="it-icon">‚è≥</div><div><strong>Duraci√≥n estimada:</strong> Inicio 4:00 pm ‚Äî Se estima evento hasta las 11:00 pm aprox.</div></div>
          <div class="it-item"><div class="it-icon">üëó</div><div><strong>C√≥digo de vestimenta:</strong> Formal ‚Äî tonos recomendados: celestes, beige, gris, verde, rosa.<br> <em>Dejemos el blanco para la novia.</em>
            <div style="margin-top:8px"><img src="vestimenta_formal.png" alt="Vestimenta" style="max-width:160px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.12)"></div>
          </div></div>
        </div>

        <div style="text-align:center;margin-top:16px">
          <button class="magicBtn" id="openRsvp">Confirmar asistencia</button>
        </div>
      </div>
    </section>

    <!-- Page 4: Galer√≠a + Buenos deseos -->
    <section class="section page4" id="gallerySection" data-name="galeria" data-bg="fondo_floral3.jpg">
      <div class="overlay"></div>
      <div class="card">
        <h2 class="sub">Galer√≠a ‚Äî Los novios</h2>
        <div class="gallery-grid" id="galleryGrid">
          <img src="momento1.jpg" alt>
          <img src="momento2.jpg" alt>
          <img src="momento3.jpg" alt>
          <img src="momento4.jpg" alt>
          <img src="momento5.jpg" alt>
        </div>

        <div style="text-align:center;margin-top:12px;">
          <button class="magicBtn" id="prevPhoto">Anterior</button>
          <button class="magicBtn" id="nextPhoto">Siguiente</button>
        </div>

        <hr style="margin:18px 0;border:none;border-top:1px solid rgba(0,0,0,0.06)">

        <h2 class="sub">Buenos deseos</h2>
        <div style="text-align:center;margin-bottom:12px">
          <textarea id="wishText" placeholder="Escribe tu mensaje para los novios" style="width:100%;min-height:90px;padding:12px;border-radius:10px;border:1px solid #ddd"></textarea>
        </div>
        <div style="text-align:center"><button class="magicBtn" id="sendWish">Enviar deseo</button></div>
        <h3 style="margin-top:18px">Mensajes p√∫blicos</h3>
        <div id="wishesList" style="max-height:260px;overflow:auto;padding:8px;border-radius:8px;background:rgba(255,255,255,0.9)"></div>
      </div>
    </section>

    <!-- Page 5: Galer√≠a colaborativa + Final/WhatsApp -->
    <section class="section page5 final" id="finalSection" data-name="final" data-bg="fondo_floral4.png">
      <div class="overlay"></div>
      <div class="card">
        <h2 class="sub">Momentos de los invitados</h2>
        <div class="gallery-grid" id="collabGrid">
          <img src="momento6.jpg" alt>
        </div>
        <p style="text-align:center;margin-top:12px">Contribuye con tus fotos/videos: <a href="https://docs.google.com/forms/d/e/1FAIpQLSfDX9Ky8YrQ962Uxh5ibEYGDk2WsyyVUxUPC09IcwrBKlHx7A/viewform?usp=header" target="_blank">Subir momento</a></p>

        <hr style="margin:18px 0;border:none;border-top:1px solid rgba(0,0,0,0.06)">

        <h2 class="sub">Con amor eterno Abril y Pablo</h2>
        <p style="text-align:center;font-family:'Playfair Display',serif;font-size:18px;margin-top:8px;">Gracias por acompa√±arnos en este d√≠a tan especial.</p>
        <div style="text-align:center;margin-top:12px;">
          <a class="magicBtn" href="#" id="addCalendar">Agregar al calendario</a>
          <button class="magicBtn" id="downloadPdf">Descargar invitaci√≥n (PDF)</button>
        </div>
        <div style="text-align:center;margin-top:12px;">
          <a class="magicBtn" href="https://wa.me/5217774914500" target="_blank">WhatsApp Abril</a>
          <a class="magicBtn" href="https://wa.me/5217341123645" target="_blank">WhatsApp Pablo</a>
        </div>
      </div>
    </section>
  </div>

  <!-- RSVP modal box (embedded form) -->
  <div class="modal" id="rsvpModal" aria-hidden="true">
    <div class="box">
      <h3>Confirmaci√≥n de asistencia</h3>
      <form id="rsvpForm">
        <label>Nombre completo<br><input name="name" required style="width:100%"></label><br><br>
        <label>Correo (opcional)<br><input name="email" style="width:100%"></label><br><br>
        <label>N√∫mero de acompa√±antes<br><input name="guests" type="number" min="0" value="0" style="width:100%"></label><br><br>
        <div style="text-align:right"><button type="button" id="closeRsvp" class="magicBtn">Cancelar</button> <button type="submit" class="magicBtn">Enviar</button></div>
      </form>
    </div>
  </div>

  <script>
    /* -------------------------
       NAVIGATION BETWEEN SECTIONS
       ------------------------- */
    const sections = Array.from(document.querySelectorAll('.section'));
    function showSectionByName(name){
      sections.forEach(s=>{ s.classList.remove('active','prev','next') });
      const idx = sections.findIndex(s=>s.dataset.name===name);
      if(idx===-1) return;
      sections.forEach((s,i)=>{ if(i<idx) s.classList.add('prev'); if(i>idx) s.classList.add('next'); });
      sections[idx].classList.add('active');
      currentIndex = idx;
      // ensure parallax initial position is centered for the new active section
      setBackgroundPositionCentered(sections[idx]);
    }

    // initial
    let currentIndex = 0;
    showSectionByName('portada');

    /* -------------------------
       AUDIO + RING BEHAVIOR
       ------------------------- */
    const ringBtn = document.getElementById('ringBtn');
    const marcha = document.getElementById('marcha');
    const eternamente = document.getElementById('eternamente');
    const clickRingBtn = document.getElementById('clickRingBtn');
    const pauseMarchBtn = document.getElementById('pauseMarchBtn');
    const toggleEtern = document.getElementById('toggleEtern');

    function openParents(){
      try{ marcha.pause(); }catch(e){}
      try{ eternamente.currentTime=0; eternamente.play(); }catch(e){}
      // spark visual
      ringBtn.classList.add('clicked'); setTimeout(()=>ringBtn.classList.remove('clicked'),900);
      showSectionByName('padres');
      document.getElementById('parentsSection').scrollIntoView({behavior:'smooth'});
    }
    ringBtn.addEventListener('click',openParents);
    clickRingBtn.addEventListener('click',openParents);
    pauseMarchBtn.addEventListener('click',()=>marcha.pause());

    function updateToggleEtern(){ toggleEtern.textContent = eternamente.paused ? 'Reproducir eternamente' : 'Pausar eternamente'; }
    toggleEtern.addEventListener('click', ()=>{ if(eternamente.paused){ eternamente.play(); } else { eternamente.pause(); } updateToggleEtern(); });
    eternamente.addEventListener('play', updateToggleEtern);
    eternamente.addEventListener('pause', updateToggleEtern);

    /* -------------------------
       COUNTDOWN to 28 Dec 2025
       ------------------------- */
    const countdownEl = document.getElementById('countdown');
    const target = new Date('2025-12-28T00:00:00');
    function tick(){
      const now = new Date();
      let diff = target - now;
      if(diff<=0){countdownEl.innerHTML='<div class="box"><div class="num">0</div><div class="label">D√≠as</div></div>';return}
      const d = Math.floor(diff/1000/60/60/24); diff-=d*24*60*60*1000;
      const h = Math.floor(diff/1000/60/60); diff-=h*60*60*1000;
      const m = Math.floor(diff/1000/60); diff-=m*60*1000;
      const s = Math.floor(diff/1000);
      countdownEl.innerHTML = `
        <div class="box"><div class="num">${d}</div><div class="label">D√≠as</div></div>
        <div class="box"><div class="num">${h}</div><div class="label">Horas</div></div>
        <div class="box"><div class="num">${m}</div><div class="label">Minutos</div></div>
        <div class="box"><div class="num">${s}</div><div class="label">Segundos</div></div>`;
    }
    setInterval(tick,1000); tick();

    /* -------------------------
       GALLERY (page 4) simple prev/next focus
       ------------------------- */
    const photos = ['momento1.jpg','momento2.jpg','momento3.jpg','momento4.jpg','momento5.jpg'];
    let photoIndex = 0;
    const galleryGrid = document.getElementById('galleryGrid');
    function renderGallery(){
      galleryGrid.innerHTML = photos.map((p,i)=>`<img src="${p}" alt data-index="${i}" style="opacity:${i===photoIndex?1:0.45};transition:opacity .4s">`).join('');
    }
    document.getElementById('prevPhoto').addEventListener('click',()=>{ photoIndex=(photoIndex-1+photos.length)%photos.length; renderGallery(); });
    document.getElementById('nextPhoto').addEventListener('click',()=>{ photoIndex=(photoIndex+1)%photos.length; renderGallery(); });
    renderGallery();

    /* -------------------------
       RSVP modal and POST to Google Apps Script endpoint (kept original)
       ------------------------- */
    const rsvpModal = document.getElementById('rsvpModal');
    const openRsvp = document.getElementById('openRsvp');
    const closeRsvp = document.getElementById('closeRsvp');
    const rsvpForm = document.getElementById('rsvpForm');
    const rsvpEndpoint = 'https://script.google.com/macros/s/AKfycbyDEgVJzj-vGvwxFE1eqTmKb4pO4__lXB9gX8gMKGc2yGhlzR15AFPY8vQMvnjoNs01Vg/exec';

    openRsvp.addEventListener('click',()=>{ rsvpModal.classList.add('open'); rsvpModal.setAttribute('aria-hidden','false'); });
    closeRsvp.addEventListener('click',()=>{ rsvpModal.classList.remove('open'); rsvpModal.setAttribute('aria-hidden','true'); });
    rsvpForm.addEventListener('submit',async (e)=>{
      e.preventDefault();
      const data = new FormData(rsvpForm);
      const payload = {};
      data.forEach((v,k)=>payload[k]=v);
      try{
        await fetch(rsvpEndpoint, {method:'POST',body:JSON.stringify(payload),headers:{'Content-Type':'application/json'}});
        alert('Confirmaci√≥n enviada. Gracias!');
        rsvpModal.classList.remove('open');
      }catch(err){console.error(err);alert('No se pudo enviar. Intenta de nuevo.');}
    });

    /* -------------------------
       Wishes: send to Google Apps Script and render list (kept original)
       ------------------------- */
    const wishesEndpoint = 'https://script.google.com/macros/s/AKfycbwY2G6aHz1-W9Sk3CUspgJYNf2EhEchr_gNk4mvaZS4wXn7sKIfIV3Qy-Wje2UCKdgC/exec';
    const sendWishBtn = document.getElementById('sendWish');
    const wishText = document.getElementById('wishText');
    const wishesList = document.getElementById('wishesList');

    async function loadWishes(){
      try{
        const res = await fetch(wishesEndpoint+'?action=list');
        const data = await res.json();
        wishesList.innerHTML = data.map(w=>`<div style="padding:8px;border-bottom:1px solid #eee"><strong>${w.name||'Anon'}</strong><div>${w.message}</div></div>`).join('');
      }catch(e){wishesList.innerHTML='<div class="small">No fue posible cargar los deseos (temporal)</div>'}
    }
    sendWishBtn.addEventListener('click',async ()=>{
      const message = wishText.value.trim();
      if(!message) return alert('Escribe un deseo');
      try{
        await fetch(wishesEndpoint,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message})});
        wishText.value=''; loadWishes();
      }catch(e){alert('No fue posible enviar el deseo.');}
    });
    loadWishes();

    /* -------------------------
       Cursor hearts (white, blue, silver, green)
       ------------------------- */
    const heartColors = ['#ffffff','#66c9ff','#c8c8c8','#a7ffcf'];
    document.addEventListener('mousemove',(e)=>{
      // limit number of hearts per move
      for(let i=0;i<2;i++){
        const heart = document.createElement('div');
        heart.className='magicHeart';
        const size = 12 + Math.random()*16;
        heart.style.width = heart.style.height = size+'px';
        heart.style.left = (e.clientX + (Math.random()*24-12))+'px';
        heart.style.top = (e.clientY + (Math.random()*24-12))+'px';
        // choose color
        const color = heartColors[Math.floor(Math.random()*heartColors.length)];
        heart.style.background = color;
        heart.style.borderRadius = '6px';
        // use a heart unicode character centered with transform
        heart.style.display = 'flex';
        heart.style.alignItems = 'center';
        heart.style.justifyContent = 'center';
        heart.style.fontSize = (size*0.6)+'px';
        heart.style.color = (color === '#ffffff' ? '#d0d0d0' : '#fff');
        heart.textContent = '‚ù§';
        document.body.appendChild(heart);
        setTimeout(()=>{ if(heart && heart.remove) heart.remove(); },1100 + Math.random()*700);
      }
    });

    /* -------------------------
       Add to Google Calendar (link) and create ICS for Apple (kept simple)
       ------------------------- */
    document.getElementById('addCalendar').addEventListener('click', (e)=>{
      e.preventDefault();
      const start = '20251228T140000'; // 2pm local
      const end = '20251228T230000';
      const title = encodeURIComponent('Boda ‚Äî Abril & Pablo');
      const details = encodeURIComponent('Ceremonia y recepci√≥n.');
      const location = encodeURIComponent('Iglesia Cristiana Palabra de Vida AD / Jard√≠n El Abuelo, Tlaquiltenango');
      const gcal = `https://www.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${start}/${end}&details=${details}&location=${location}`;
      window.open(gcal,'_blank');
    });

    document.getElementById('downloadPdf').addEventListener('click',()=>{ window.print(); });

    /* -------------------------
       Arrow navigation and keyboard
       ------------------------- */
    window.addEventListener('keydown', (e)=>{
      if(e.key==='ArrowRight'){ const next = (currentIndex+1)%sections.length; showSectionByName(sections[next].dataset.name); }
      else if(e.key==='ArrowLeft'){ const prev = (currentIndex-1+sections.length)%sections.length; showSectionByName(sections[prev].dataset.name); }
    });

    // also simple previous/next by clicking nav buttons on each card (delegation)
    document.addEventListener('click', (e)=>{
      if(e.target.matches('.nav-next')) { const next = (currentIndex+1)%sections.length; showSectionByName(sections[next].dataset.name); }
      if(e.target.matches('.nav-prev')) { const prev = (currentIndex-1+sections.length)%sections.length; showSectionByName(sections[prev].dataset.name); }
    });

    /* -------------------------
       PARALLAX: smooth background-position adjustments
       - works on desktop mousemove and on touchmove for mobile
       - also resets to center when section changes
       ------------------------- */
    function setBackgroundPositionCentered(section){
      section.style.backgroundPosition = '50% 50%';
    }
    sections.forEach(s => setBackgroundPositionCentered(s));

    // mouse-based parallax
    let lastMove = 0;
    window.addEventListener('mousemove', (ev)=>{
      const now = Date.now();
      if(now - lastMove < 16) return; // throttle ~60fps
      lastMove = now;
      const x = (ev.clientX / window.innerWidth - 0.5) * 12; // max 12% shift
      const y = (ev.clientY / window.innerHeight - 0.5) * 8; // max 8% shift
      // apply gentle parallax to active section
      const active = document.querySelector('.section.active');
      if(active){
        active.style.backgroundPosition = `${50 + x}% ${50 + y}%`;
      }
    });

    // touch-based parallax (for mobile)
    window.addEventListener('touchmove', (ev)=>{
      const t = ev.touches[0];
      if(!t) return;
      const x = (t.clientX / window.innerWidth - 0.5) * 10;
      const y = (t.clientY / window.innerHeight - 0.5) * 6;
      const active = document.querySelector('.section.active');
      if(active){
        active.style.backgroundPosition = `${50 + x}% ${50 + y}%`;
      }
    }, {passive:true});

    // Ensure backgrounds cover and adjust on resize
    window.addEventListener('resize', ()=>{
      sections.forEach(s => setBackgroundPositionCentered(s));
    });

    /* -------------------------
       Initialize: ensure correct active index variable
       ------------------------- */
    // find current index from active class
    currentIndex = sections.findIndex(s => s.classList.contains('active'));
    if(currentIndex === -1) { currentIndex = 0; sections[0].classList.add('active'); }

  </script>
</body>
</html>
 
